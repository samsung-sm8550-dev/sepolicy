expandtypeattribute(hal_drm)
expandtypeattribute(hal_drm_client)
expandtypeattribute(hal_drm_server)
neverallow hal_drm_server fs_type:file execute_no_trans;
neverallow hal_drm_server file_type:file execute_no_trans;
allow hal_drm_server dumpstate:fifo_file write;
allow hal_drm_server dumpstate:fd *;
allow hal_drm_server hal_drm_client:binder transfer;
allow hal_drm_server hal_drm_client:binder { call transfer };
allow hal_drm_server hal_drm_client:fd *;
allow hal_drm_server hal_drm_hwservice:hwservice_manager { add find };
allow hal_drm_server hidl_base_hwservice:hwservice_manager add;
allow hal_drm_server hal_drm_service:service_manager { add find };
allow hal_drm_server base_typeattr:fd *;
allow hal_drm_client hal_drm_server:binder { call transfer };
allow hal_drm_client hal_drm_server:binder transfer;
allow hal_drm_client hal_drm_server:fd *;
allow hal_drm_client hal_drm_hwservice:hwservice_manager find;
allow hal_drm_client hal_drm_service:service_manager find;
allow hal_drm hidl_memory_hwservice:hwservice_manager find;
allow hal_drm self:process execmem;
allow hal_drm system_data_file:file { getattr read };
allow hal_drm cgroup:dir { search write };
allow hal_drm cgroup:file w_file_perms;
allow hal_drm cgroup_v2:dir { search write };
allow hal_drm cgroup_v2:file w_file_perms;
allow hal_drm ion_device:chr_file rw_file_perms;
allow hal_drm hal_graphics_allocator:fd *;
allow hal_drm hal_allocator_server:fd *;
allow hal_drm mediaserver:fd *;
allow hal_drm sysfs:file r_file_perms;
allow hal_drm tee_device:chr_file rw_file_perms;
allow hal_drm mediacodec:fd *;
allow hal_drm_default hal_codec2_server:fd *;
allow hal_drm_default hal_omx_server:fd *;
allow hal_drm_default vndbinder_device:chr_file rw_file_perms;
allow hal_drm_default app_data_file:file { getattr read write };
allow hal_drm_default cpk_efs_file:dir r_dir_perms;
allow hal_drm_default cpk_efs_file:file r_file_perms;
allow hal_drm_default sec_efs_file:file r_file_perms;
allow hal_drm_default base_typeattr:fd *;
allow hal_drm_default vendor_mediadrm_vendor_data_file:dir create_dir_perms;
allow hal_drm_default vendor_mediadrm_vendor_data_file:file create_file_perms;
allow hal_drm_default sec_debugfs:dir r_dir_perms;
allow hal_drm_default ap_device:dir search;
allow hal_drm_default dumpstate:fifo_file getattr;
allow hal_drm_default tzdaemon:fd *;
allow hal_drm_default tz_user_device:chr_file rw_file_perms;
allow hal_drm_default tee_efs_file:dir search;
allow hal_drm_default firmware_file:file r_file_perms;
allowxperm hal_drm self:ioctl tcp_socket { range 0x5401 0x5404 0x540b range 0x540e 0x5411 range 0x5413 0x5414 range 0x5450 0x5451 };
allowxperm hal_drm self:ioctl tcp_socket { range 0x8906 0x8907 0x8910 range 0x8912 0x8913 0x8915 0x8917 0x8919 0x891b 0x8921 0x8933 0x8938 0x8942 };
allowxperm hal_drm self:ioctl tcp_socket { 0x8b01 0x8b05 0x8b07 0x8b09 0x8b0b 0x8b0d 0x8b0f range 0x8b11 0x8b13 0x8b21 0x8b23 0x8b25 0x8b27 0x8b29 0x8b2d };
allowxperm hal_drm self:ioctl udp_socket { range 0x5401 0x5404 0x540b range 0x540e 0x5411 range 0x5413 0x5414 range 0x5450 0x5451 };
allowxperm hal_drm self:ioctl udp_socket { range 0x8906 0x8907 0x8910 range 0x8912 0x8913 0x8915 0x8917 0x8919 0x891b 0x8921 0x8933 0x8938 0x8942 };
allowxperm hal_drm self:ioctl udp_socket { 0x8b01 0x8b05 0x8b07 0x8b09 0x8b0b 0x8b0d 0x8b0f range 0x8b11 0x8b13 0x8b21 0x8b23 0x8b25 0x8b27 0x8b29 0x8b2d };
allowxperm hal_drm self:ioctl rawip_socket { range 0x5401 0x5404 0x540b range 0x540e 0x5411 range 0x5413 0x5414 range 0x5450 0x5451 };
allowxperm hal_drm self:ioctl rawip_socket { range 0x8906 0x8907 0x8910 range 0x8912 0x8913 0x8915 0x8917 0x8919 0x891b 0x8921 0x8933 0x8938 0x8942 };
allowxperm hal_drm self:ioctl rawip_socket { 0x8b01 0x8b05 0x8b07 0x8b09 0x8b0b 0x8b0d 0x8b0f range 0x8b11 0x8b13 0x8b21 0x8b23 0x8b25 0x8b27 0x8b29 0x8b2d };
neverallowxperm hal_drm_server domain:ioctl tcp_socket { 0x6900 0x6902 };
neverallowxperm hal_drm_server domain:ioctl tcp_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
neverallowxperm hal_drm_server domain:ioctl tcp_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
neverallowxperm hal_drm_server domain:ioctl udp_socket { 0x6900 0x6902 };
neverallowxperm hal_drm_server domain:ioctl udp_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
neverallowxperm hal_drm_server domain:ioctl udp_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
neverallowxperm hal_drm_server domain:ioctl rawip_socket { 0x6900 0x6902 };
neverallowxperm hal_drm_server domain:ioctl rawip_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
neverallowxperm hal_drm_server domain:ioctl rawip_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
init_daemon_domain(hal_drm_default)
r_dir_file(hal_drm, cgroup)
r_dir_file(hal_drm, cgroup_v2)
get_prop(hal_drm_server, serialno_prop)
get_prop(hal_drm_default, powerctl_prop)
get_prop(hal_drm_default, debug_level_prop)
get_prop(hal_drm_default, tzdaemon_prop)
get_prop(hal_drm_default, vendor_teegris_prop)
binder_use(hal_drm_server)
hal_server_domain(hal_drm_default, hal_drm)
hal_client_domain(hal_drm_default, hal_allocator)
type hal_drm_default, domain, mlstrustedsubject;
type hal_drm_default_exec, exec_type, file_type, vendor_file_type;
type hal_drm_hwservice, hwservice_manager_type;
type hal_drm_client, base_typeattr;
type hal_drm_server, base_typeattr;
type hal_drm, base_typeattr;
