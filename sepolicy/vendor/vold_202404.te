neverallow vold_202404 fsck_exec_202404:file execute_no_trans;
allow vold_202404 update_verifier_202404:binder transfer;
allow vold_202404 vdc_202404:binder transfer;
allow vold_202404 cache_file_202404:dir r_dir_perms;
allow vold_202404 cache_file_202404:file { getattr read };
allow vold_202404 cache_file_202404:lnk_file r_file_perms;
allow vold_202404 sysfs_202404:file w_file_perms;
allow vold_202404 sysfs_devices_block_202404:file w_file_perms;
allow vold_202404 sysfs_dm_202404:file w_file_perms;
allow vold_202404 sysfs_loop_202404:file w_file_perms;
allow vold_202404 sysfs_usb_202404:file w_file_perms;
allow vold_202404 sysfs_fs_f2fs_202404:file w_file_perms;
allow vold_202404 sysfs_zram_uevent_202404:file w_file_perms;
allow vold_202404 rootfs_202404:dir mounton;
allow vold_202404 metadata_file_202404:dir search;
allow vold_202404 proc_202404:file r_file_perms;
allow vold_202404 proc_drop_caches_202404:file r_file_perms;
allow vold_202404 proc_drop_caches_202404:file w_file_perms;
allow vold_202404 proc_bootconfig_202404:file r_file_perms;
allow vold_202404 proc_cmdline_202404:file r_file_perms;
allow vold_202404 proc_filesystems_202404:file r_file_perms;
allow vold_202404 proc_meminfo_202404:file r_file_perms;
allow vold_202404 proc_mounts_202404:file r_file_perms;
allow vold_202404 file_contexts_file_202404:file r_file_perms;
allow vold_202404 self:process setexec;
allow vold_202404 self:process setfscreate;
allow vold_202404 self:capability { chown dac_override dac_read_search fowner fsetid mknod net_admin sys_admin };
allow vold_202404 self:capability { kill sys_ptrace };
allow vold_202404 self:capability sys_nice;
allow vold_202404 self:capability sys_chroot;
allow vold_202404 self:cap_userns { chown dac_override dac_read_search fowner fsetid mknod net_admin sys_admin };
allow vold_202404 self:cap_userns { kill sys_ptrace };
allow vold_202404 self:cap_userns sys_nice;
allow vold_202404 self:cap_userns sys_chroot;
allow vold_202404 self:netlink_kobject_uevent_socket create_socket_perms_no_ioctl;
allow vold_202404 self:capability2 block_suspend;
allow vold_202404 self:cap2_userns block_suspend;
allow vold_202404 e2fs_exec_202404:file rx_file_perms;
allow vold_202404 system_file_202404:file x_file_perms;
allow vold_202404 block_device_202404:dir create_dir_perms;
allow vold_202404 device_202404:dir write;
allow vold_202404 devpts_202404:chr_file rw_file_perms;
allow vold_202404 sdcard_type:dir mounton;
allow vold_202404 sdcard_type:dir create_dir_perms;
allow vold_202404 sdcard_type:filesystem { mount remount unmount };
allow vold_202404 sdcard_type:file create_file_perms;
allow vold_202404 fuse_202404:dir mounton;
allow vold_202404 fuse_202404:dir create_dir_perms;
allow vold_202404 fuse_202404:filesystem { mount remount unmount };
allow vold_202404 fuse_202404:filesystem relabelfrom;
allow vold_202404 fuse_202404:file create_file_perms;
allow vold_202404 mnt_media_rw_file_202404:dir create_dir_perms;
allow vold_202404 mnt_media_rw_file_202404:file create_file_perms;
allow vold_202404 storage_file_202404:dir create_dir_perms;
allow vold_202404 storage_file_202404:dir mounton;
allow vold_202404 storage_file_202404:file create_file_perms;
allow vold_202404 media_rw_data_file_202404:dir create_dir_perms;
allow vold_202404 media_rw_data_file_202404:dir mounton;
allow vold_202404 media_rw_data_file_202404:file create_file_perms;
allow vold_202404 mnt_media_rw_stub_file_202404:dir { create getattr mounton rmdir setattr };
allow vold_202404 storage_stub_file_202404:dir { create getattr mounton rmdir setattr };
allow vold_202404 mnt_user_file_202404:dir { create_dir_perms mounton };
allow vold_202404 mnt_user_file_202404:lnk_file create_file_perms;
allow vold_202404 mnt_user_file_202404:file create_file_perms;
allow vold_202404 mnt_pass_through_file_202404:dir { create_dir_perms mounton };
allow vold_202404 mnt_pass_through_file_202404:lnk_file create_file_perms;
allow vold_202404 mnt_expand_file_202404:dir { create_dir_perms mounton };
allow vold_202404 apk_data_file_202404:dir { create getattr setattr };
allow vold_202404 apk_data_file_202404:dir { mounton rw_dir_perms };
allow vold_202404 apk_data_file_202404:file { rw_file_perms unlink };
allow vold_202404 shell_data_file_202404:dir { create getattr setattr };
allow vold_202404 system_userdir_file_202404:dir { create getattr setattr };
allow vold_202404 media_userdir_file_202404:dir { create getattr ioctl open read setattr };
allow vold_202404 apk_tmp_file_202404:dir { mounton r_dir_perms };
allow vold_202404 incremental_control_file_202404:file { r_file_perms relabelto };
allow vold_202404 tmpfs_202404:filesystem { mount unmount };
allow vold_202404 tmpfs_202404:dir create_dir_perms;
allow vold_202404 tmpfs_202404:dir mounton;
allow vold_202404 loop_control_device_202404:chr_file rw_file_perms;
allow vold_202404 loop_device_202404:blk_file { create rw_file_perms setattr unlink };
allow vold_202404 vold_device_202404:blk_file { create rw_file_perms setattr unlink };
allow vold_202404 dm_device_202404:chr_file rw_file_perms;
allow vold_202404 dm_device_202404:blk_file rw_file_perms;
allow vold_202404 domain:process { sigkill signal };
allow vold_202404 kmsg_device_202404:chr_file rw_file_perms;
allow vold_202404 fsck_exec_202404:file { execute r_file_perms };
allow vold_202404 fscklogs_202404:dir rw_dir_perms;
allow vold_202404 fscklogs_202404:file create_file_perms;
allow vold_202404 labeledfs_202404:filesystem { mount remount unmount };
allow vold_202404 system_data_root_file_202404:dir { create_dir_perms mounton };
allow vold_202404 system_data_file_202404:dir { create_dir_perms mounton };
allow vold_202404 system_data_file_202404:lnk_file getattr;
allow vold_202404 system_data_file_202404:file read;
allow vold_202404 vendor_data_file_202404:dir create_dir_perms;
allow vold_202404 kernel_202404:process setsched;
allow vold_202404 asec_image_file_202404:file create_file_perms;
allow vold_202404 asec_image_file_202404:dir rw_dir_perms;
allow vold_202404 asec_apk_file_202404:dir { create_dir_perms mounton relabelfrom relabelto };
allow vold_202404 asec_apk_file_202404:file { r_file_perms relabelfrom relabelto setattr };
allow vold_202404 asec_public_file_202404:dir { relabelto setattr };
allow vold_202404 asec_public_file_202404:file { relabelto setattr };
allow vold_202404 unlabeled_202404:dir { r_dir_perms relabelfrom setattr };
allow vold_202404 unlabeled_202404:file { r_file_perms relabelfrom setattr };
allow vold_202404 fusectlfs_202404:file rw_file_perms;
allow vold_202404 fusectlfs_202404:dir rw_dir_perms;
allow vold_202404 sysfs_wake_lock_202404:file rw_file_perms;
allow vold_202404 system_suspend_server:binder { call transfer };
allow vold_202404 system_suspend_server:fd *;
allow vold_202404 system_suspend_hwservice_202404:hwservice_manager find;
allow vold_202404 hwservicemanager_202404:binder { call transfer };
allow vold_202404 hidl_manager_hwservice_202404:hwservice_manager find;
allow vold_202404 hal_system_suspend_service_202404:service_manager find;
allow vold_202404 servicemanager_202404:binder { call transfer };
allow vold_202404 su_202404:tcp_socket { accept getopt read write };
allow vold_202404 system_server_202404:binder { call transfer };
allow vold_202404 system_server_202404:fd *;
allow vold_202404 permission_service_202404:service_manager find;
allow vold_202404 userdata_block_device_202404:blk_file rw_file_perms;
allow vold_202404 zoned_block_device_202404:blk_file rw_file_perms;
allow vold_202404 metadata_block_device_202404:blk_file rw_file_perms;
allow vold_202404 unencrypted_data_file_202404:file create_file_perms;
allow vold_202404 unencrypted_data_file_202404:dir create_dir_perms;
allow vold_202404 vold_data_file_202404:dir create_dir_perms;
allow vold_202404 vold_data_file_202404:file create_file_perms;
allow vold_202404 vold_metadata_file_202404:dir create_dir_perms;
allow vold_202404 vold_metadata_file_202404:file create_file_perms;
allow vold_202404 init_202404:key { search setattr write };
allow vold_202404 vold_202404:key { search setattr write };
allow vold_202404 fuse_device_202404:chr_file rw_file_perms;
allow vold_202404 app_fusefs_202404:filesystem { relabelfrom relabelto };
allow vold_202404 app_fusefs_202404:filesystem { mount unmount };
allow vold_202404 app_fuse_file_202404:dir rw_dir_perms;
allow vold_202404 app_fuse_file_202404:file { append getattr open read write };
allow vold_202404 toolbox_exec_202404:file rx_file_perms;
allow vold_202404 user_profile_root_file_202404:dir create_dir_perms;
allow vold_202404 user_profile_data_file_202404:dir create_dir_perms;
allow vold_202404 misc_block_device_202404:blk_file w_file_perms;
allow vold_202404 mnt_vendor_file_202404:dir search;
allow vold_202404 mnt_vendor_file_202404:dir { ioctl open read };
allow vold_202404 gsi_metadata_file_type:dir search;
allow vold_202404 gsi_public_metadata_file_202404:file r_file_perms;
allow vold_202404 vendor_apex_file_202404:file r_file_perms;
allow vold_202404 vendor_sysfs_mmc_host:file w_file_perms;
dontaudit vold_202404 self:capability sys_resource;
dontaudit vold_202404 self:cap_userns sys_resource;
allowxperm vold_202404 fs_type:ioctl dir 0x5879;
allowxperm vold_202404 file_type:ioctl dir 0x5879;
allowxperm vold_202404 data_file_type:ioctl dir { 0x6613 0x6615 range 0x6617 0x6618 0x661a };
allowxperm vold_202404 vold_metadata_file_202404:ioctl file 0x660b;
allowxperm vold_202404 vold_metadata_file_202404:ioctl file 0xf514;
allowxperm vold_202404 vold_data_file_202404:ioctl file 0x660b;
allowxperm vold_202404 vold_data_file_202404:ioctl file 0xf514;
allowxperm vold_202404 media_rw_data_file_202404:ioctl file { range 0x581f 0x5820 };
allowxperm vold_202404 media_rw_data_file_202404:ioctl file { range 0x6601 0x6602 };
allowxperm vold_202404 media_rw_data_file_202404:ioctl dir { range 0x581f 0x5820 };
allowxperm vold_202404 media_rw_data_file_202404:ioctl dir { range 0x6601 0x6602 };
allowxperm vold_202404 media_userdir_file_202404:ioctl dir { range 0x6601 0x6602 };
allowxperm vold_202404 loop_device_202404:ioctl blk_file { range 0x4c00 0x4c01 range 0x4c04 0x4c05 0x4c82 };
allowxperm vold_202404 vold_device_202404:ioctl blk_file { 0x1260 0x1277 };
allowxperm vold_202404 dm_device_202404:ioctl blk_file { 0x1277 0x127d range 0x1282 0x1283 };
allowxperm vold_202404 userdata_block_device_202404:ioctl blk_file 0x127d;
allowxperm vold_202404 metadata_block_device_202404:ioctl blk_file 0x127d;
r_dir_file(vold_202404, rootfs_202404)
r_dir_file(vold_202404, metadata_file_202404)
r_dir_file(vold_202404, domain)
get_prop(vold_202404, hwservicemanager_prop_202404)
get_prop(vold_202404, vendor_tee_listener_prop)
hal_client_domain(vold_202404, hal_bootctl)
hal_client_domain(vold_202404, hal_health_storage)
add_service(vold_202404, vold_service_202404)
type vold_202404, domain, mlstrustedsubject;
