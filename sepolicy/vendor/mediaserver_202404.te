neverallow mediaserver_202404 fs_type:file execute_no_trans;
neverallow mediaserver_202404 file_type:file execute_no_trans;
allow mediaserver_202404 drmserver_202404:binder transfer;
allow mediaserver_202404 drmserver_202404:unix_stream_socket connectto;
allow mediaserver_202404 drmserver_202404:drmservice *;
allow mediaserver_202404 sdcard_type:file write;
allow mediaserver_202404 fuse_202404:file write;
allow mediaserver_202404 proc_202404:lnk_file getattr;
allow mediaserver_202404 system_file_202404:dir r_dir_perms;
allow mediaserver_202404 self:process ptrace;
allow mediaserver_202404 servicemanager_202404:binder { call transfer };
allow mediaserver_202404 binderservicedomain:binder { call transfer };
allow mediaserver_202404 binderservicedomain:fd *;
allow mediaserver_202404 appdomain:binder { call transfer };
allow mediaserver_202404 appdomain:fd *;
allow mediaserver_202404 appdomain:fifo_file { getattr read write };
allow mediaserver_202404 media_data_file_202404:dir create_dir_perms;
allow mediaserver_202404 media_data_file_202404:file create_file_perms;
allow mediaserver_202404 app_data_file_202404:file { append getattr ioctl lock map read write };
allow mediaserver_202404 privapp_data_file_202404:file { append getattr ioctl lock map read write };
allow mediaserver_202404 gpu_device_202404:chr_file rw_file_perms;
allow mediaserver_202404 gpu_device_202404:dir r_dir_perms;
allow mediaserver_202404 video_device_202404:dir r_dir_perms;
allow mediaserver_202404 video_device_202404:chr_file rw_file_perms;
allow mediaserver_202404 apk_data_file_202404:file { getattr read };
allow mediaserver_202404 asec_apk_file_202404:file { getattr read };
allow mediaserver_202404 ringtone_file_202404:file { getattr read };
allow mediaserver_202404 radio_data_file_202404:file { getattr read };
allow mediaserver_202404 rpmsg_device_202404:chr_file rw_file_perms;
allow mediaserver_202404 system_server_202404:fifo_file r_file_perms;
allow mediaserver_202404 system_server_202404:fd *;
allow mediaserver_202404 media_rw_data_file_202404:dir create_dir_perms;
allow mediaserver_202404 media_rw_data_file_202404:file create_file_perms;
allow mediaserver_202404 app_fuse_file_202404:file { getattr read };
allow mediaserver_202404 drmserver_socket_202404:sock_file write;
allow mediaserver_202404 bluetooth_socket_202404:sock_file write;
allow mediaserver_202404 bluetooth_202404:unix_stream_socket connectto;
allow mediaserver_202404 statsdw_socket_202404:sock_file write;
allow mediaserver_202404 statsd_202404:unix_dgram_socket sendto;
allow mediaserver_202404 statsd_202404:binder transfer;
allow mediaserver_202404 su_202404:tcp_socket { accept getopt read write };
allow mediaserver_202404 activity_service_202404:service_manager find;
allow mediaserver_202404 appops_service_202404:service_manager find;
allow mediaserver_202404 audio_service_202404:service_manager find;
allow mediaserver_202404 audioserver_service_202404:service_manager find;
allow mediaserver_202404 cameraserver_service_202404:service_manager find;
allow mediaserver_202404 batterystats_service_202404:service_manager find;
allow mediaserver_202404 drmserver_service_202404:service_manager find;
allow mediaserver_202404 mediaextractor_service_202404:service_manager find;
allow mediaserver_202404 mediametrics_service_202404:service_manager find;
allow mediaserver_202404 media_session_service_202404:service_manager find;
allow mediaserver_202404 package_native_service_202404:service_manager find;
allow mediaserver_202404 permission_service_202404:service_manager find;
allow mediaserver_202404 permission_checker_service_202404:service_manager find;
allow mediaserver_202404 power_service_202404:service_manager find;
allow mediaserver_202404 processinfo_service_202404:service_manager find;
allow mediaserver_202404 scheduling_policy_service_202404:service_manager find;
allow mediaserver_202404 surfaceflinger_service_202404:service_manager find;
allow mediaserver_202404 mediadrmserver_service_202404:service_manager find;
allow mediaserver_202404 hidl_token_hwservice_202404:hwservice_manager find;
allow mediaserver_202404 oemfs_202404:dir search;
allow mediaserver_202404 oemfs_202404:file r_file_perms;
allow mediaserver_202404 bootanim_oem_file_202404:file r_file_perms;
allow mediaserver_202404 vendor_app_file_202404:file { getattr map read };
allow mediaserver_202404 preloads_media_file_202404:file { getattr ioctl read };
allow mediaserver_202404 ion_device_202404:chr_file r_file_perms;
allow mediaserver_202404 dmabuf_system_heap_device_202404:chr_file r_file_perms;
allow mediaserver_202404 dmabuf_system_secure_heap_device_202404:chr_file r_file_perms;
allow mediaserver_202404 hal_graphics_allocator:fd *;
allow mediaserver_202404 hal_graphics_composer:fd *;
allow mediaserver_202404 hal_camera:fd *;
allow mediaserver_202404 vold_202404:fd *;
allow mediaserver_202404 vendor_overlay_file_202404:file { getattr map read };
dontaudit mediaserver_202404 vendor_hal_qspmhal_hwservice:hwservice_manager find;
allowxperm mediaserver_202404 self:ioctl tcp_socket { range 0x5401 0x5404 0x540b range 0x540e 0x5411 range 0x5413 0x5414 range 0x5450 0x5451 };
allowxperm mediaserver_202404 self:ioctl tcp_socket { range 0x8906 0x8907 0x8910 range 0x8912 0x8913 0x8915 0x8917 0x8919 0x891b 0x8921 0x8933 0x8938 0x8942 };
allowxperm mediaserver_202404 self:ioctl tcp_socket { 0x8b01 0x8b05 0x8b07 0x8b09 0x8b0b 0x8b0d 0x8b0f range 0x8b11 0x8b13 0x8b21 0x8b23 0x8b25 0x8b27 0x8b29 0x8b2d };
allowxperm mediaserver_202404 self:ioctl udp_socket { range 0x5401 0x5404 0x540b range 0x540e 0x5411 range 0x5413 0x5414 range 0x5450 0x5451 };
allowxperm mediaserver_202404 self:ioctl udp_socket { range 0x8906 0x8907 0x8910 range 0x8912 0x8913 0x8915 0x8917 0x8919 0x891b 0x8921 0x8933 0x8938 0x8942 };
allowxperm mediaserver_202404 self:ioctl udp_socket { 0x8b01 0x8b05 0x8b07 0x8b09 0x8b0b 0x8b0d 0x8b0f range 0x8b11 0x8b13 0x8b21 0x8b23 0x8b25 0x8b27 0x8b29 0x8b2d };
allowxperm mediaserver_202404 self:ioctl rawip_socket { range 0x5401 0x5404 0x540b range 0x540e 0x5411 range 0x5413 0x5414 range 0x5450 0x5451 };
allowxperm mediaserver_202404 self:ioctl rawip_socket { range 0x8906 0x8907 0x8910 range 0x8912 0x8913 0x8915 0x8917 0x8919 0x891b 0x8921 0x8933 0x8938 0x8942 };
allowxperm mediaserver_202404 self:ioctl rawip_socket { 0x8b01 0x8b05 0x8b07 0x8b09 0x8b0b 0x8b0d 0x8b0f range 0x8b11 0x8b13 0x8b21 0x8b23 0x8b25 0x8b27 0x8b29 0x8b2d };
neverallowxperm mediaserver_202404 domain:ioctl tcp_socket { 0x6900 0x6902 };
neverallowxperm mediaserver_202404 domain:ioctl tcp_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
neverallowxperm mediaserver_202404 domain:ioctl tcp_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
neverallowxperm mediaserver_202404 domain:ioctl udp_socket { 0x6900 0x6902 };
neverallowxperm mediaserver_202404 domain:ioctl udp_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
neverallowxperm mediaserver_202404 domain:ioctl udp_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
neverallowxperm mediaserver_202404 domain:ioctl rawip_socket { 0x6900 0x6902 };
neverallowxperm mediaserver_202404 domain:ioctl rawip_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
neverallowxperm mediaserver_202404 domain:ioctl rawip_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
r_dir_file(mediaserver_202404, sdcard_type)
r_dir_file(mediaserver_202404, fuse_202404)
r_dir_file(mediaserver_202404, cgroup_202404)
r_dir_file(mediaserver_202404, cgroup_v2_202404)
r_dir_file(mediaserver_202404, media_rw_data_file_202404)
get_prop(mediaserver_202404, vendor_audio_prop)
binder_service(mediaserver_202404)
net_domain(mediaserver_202404)
hal_client_domain(mediaserver_202404, hal_allocator)
hal_client_domain(mediaserver_202404, hal_audio)
add_service(mediaserver_202404, mediaserver_service_202404)
type mediaserver_202404, domain, mlstrustedsubject;
