neverallow fsck_untrusted dm_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted root_block_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted frp_block_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted system_block_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted recovery_block_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted boot_block_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted userdata_block_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted cache_block_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted swap_block_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted metadata_block_device:blk_file no_rw_file_perms;
neverallow fsck_untrusted self:capability { setgid setuid };
neverallow fsck_untrusted self:cap_userns { setgid setuid };
allow fsck_untrusted devpts:chr_file { getattr ioctl read write };
allow fsck_untrusted vold:fd *;
allow fsck_untrusted vold:fifo_file { getattr read write };
allow fsck_untrusted block_device:dir search;
allow fsck_untrusted vold_device:blk_file rw_file_perms;
allow fsck_untrusted proc_mounts:file r_file_perms;
allow fsck_untrusted dev_type:blk_file getattr;
dontaudit fsck_untrusted sysfs:file { append getattr ioctl lock map open read watch watch_reads write };
dontaudit fsck_untrusted sysfs_dm:file { append getattr ioctl lock map open read watch watch_reads write };
dontaudit fsck_untrusted sysfs_dm:dir { add_name getattr ioctl lock open read remove_name search watch watch_reads write };
dontaudit fsck_untrusted tmpfs:lnk_file read;
dontaudit fsck_untrusted vendor_sysfs_usb_node:dir { add_name getattr ioctl lock open read remove_name search watch watch_reads write };
dontaudit fsck_untrusted vendor_sysfs_usb_node:file { append getattr ioctl lock map open read watch watch_reads write };
type fsck_untrusted, domain;
