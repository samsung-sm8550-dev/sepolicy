neverallow netd_202404 dev_type:blk_file { read write };
neverallow netd_202404 domain:process ptrace;
neverallow netd_202404 system_file_type:file write;
neverallow netd_202404 system_file_type:dir write;
neverallow netd_202404 system_file_type:lnk_file write;
neverallow netd_202404 system_file_type:chr_file write;
neverallow netd_202404 system_file_type:blk_file write;
neverallow netd_202404 system_file_type:sock_file write;
neverallow netd_202404 system_file_type:fifo_file write;
neverallow netd_202404 app_data_file_type:file write;
neverallow netd_202404 app_data_file_type:dir write;
neverallow netd_202404 app_data_file_type:lnk_file write;
neverallow netd_202404 app_data_file_type:chr_file write;
neverallow netd_202404 app_data_file_type:blk_file write;
neverallow netd_202404 app_data_file_type:sock_file write;
neverallow netd_202404 app_data_file_type:fifo_file write;
neverallow netd_202404 system_data_file_202404:file write;
neverallow netd_202404 system_data_file_202404:dir write;
neverallow netd_202404 system_data_file_202404:lnk_file write;
neverallow netd_202404 system_data_file_202404:chr_file write;
neverallow netd_202404 system_data_file_202404:blk_file write;
neverallow netd_202404 system_data_file_202404:sock_file write;
neverallow netd_202404 system_data_file_202404:fifo_file write;
neverallow netd_202404 proc_net_202404:dir no_w_dir_perms;
neverallow netd_202404 sysfs_net_202404:dir no_w_dir_perms;
neverallow netd_202404 self:capability sys_admin;
allow netd_202404 dumpstate_202404:binder transfer;
allow netd_202404 dumpstate_202404:fifo_file { getattr write };
allow netd_202404 mdnsd_socket_202404:sock_file write;
allow netd_202404 mdnsd_202404:unix_stream_socket connectto;
allow netd_202404 system_server_202404:fd *;
allow netd_202404 system_server_202404:binder call;
allow netd_202404 self:capability { kill net_admin net_raw };
allow netd_202404 self:capability { chown dac_override dac_read_search };
allow netd_202404 self:capability fowner;
allow netd_202404 self:cap_userns { kill net_admin net_raw };
allow netd_202404 self:cap_userns { chown dac_override dac_read_search };
allow netd_202404 self:cap_userns fowner;
allow netd_202404 self:tun_socket create;
allow netd_202404 self:netlink_kobject_uevent_socket create_socket_perms_no_ioctl;
allow netd_202404 self:netlink_route_socket nlmsg_write;
allow netd_202404 self:netlink_nflog_socket create_socket_perms_no_ioctl;
allow netd_202404 self:netlink_socket create_socket_perms_no_ioctl;
allow netd_202404 self:netlink_tcpdiag_socket { create_socket_perms_no_ioctl nlmsg_read nlmsg_write };
allow netd_202404 self:netlink_generic_socket create_socket_perms_no_ioctl;
allow netd_202404 self:netlink_netfilter_socket create_socket_perms_no_ioctl;
allow netd_202404 self:netlink_xfrm_socket { create_socket_perms_no_ioctl nlmsg_read nlmsg_write };
allow netd_202404 tun_device_202404:chr_file rw_file_perms;
allow netd_202404 shell_exec_202404:file rx_file_perms;
allow netd_202404 system_file_202404:file x_file_perms;
allow netd_202404 system_file_202404:file lock;
allow netd_202404 devpts_202404:chr_file rw_file_perms;
allow netd_202404 proc_qtaguid_ctrl_202404:file rw_file_perms;
allow netd_202404 qtaguid_device_202404:chr_file r_file_perms;
allow netd_202404 proc_net_type:file rw_file_perms;
allow netd_202404 sysfs_202404:dir r_dir_perms;
allow netd_202404 sysfs_net_202404:file w_file_perms;
allow netd_202404 sysfs_usb_202404:file write;
allow netd_202404 net_data_file_202404:file create_file_perms;
allow netd_202404 net_data_file_202404:dir rw_dir_perms;
allow netd_202404 dnsmasq_202404:process { sigkill signal };
allow netd_202404 servicemanager_202404:binder { call transfer };
allow netd_202404 su_202404:tcp_socket { accept getopt read write };
allow netd_202404 permission_service_202404:service_manager find;
allow netd_202404 netd_listener_service_202404:service_manager find;
allow netd_202404 netdomain:tcp_socket { getattr getopt read setattr setopt write };
allow netd_202404 netdomain:udp_socket { getattr getopt read setattr setopt write };
allow netd_202404 netdomain:rawip_socket { getattr getopt read setattr setopt write };
allow netd_202404 netdomain:tun_socket { getattr getopt read setattr setopt write };
allow netd_202404 netdomain:icmp_socket { getattr getopt read setattr setopt write };
allow netd_202404 netdomain:fd *;
allow netd_202404 system_net_netd_hwservice_202404:hwservice_manager { add find };
allow netd_202404 hidl_base_hwservice_202404:hwservice_manager add;
allow netd_202404 hwservicemanager_202404:binder { call transfer };
allow netd_202404 vendor_netmgrd:binder transfer;
dontaudit netd_202404 self:capability fsetid;
dontaudit netd_202404 self:capability sys_admin;
dontaudit netd_202404 self:capability sys_module;
dontaudit netd_202404 self:cap_userns fsetid;
dontaudit netd_202404 system_file_202404:dir write;
dontaudit netd_202404 proc_net_202404:dir write;
dontaudit netd_202404 sysfs_net_202404:dir write;
dontaudit netd_202404 appdomain:unix_stream_socket { read write };
dontaudit netd_202404 kernel_202404:system module_request;
allowxperm netd_202404 self:ioctl udp_socket { 0x6900 0x6902 };
allowxperm netd_202404 self:ioctl udp_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
allowxperm netd_202404 self:ioctl udp_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
allowxperm netd_202404 tun_device_202404:ioctl chr_file { 0x54ca 0x54d2 };
r_dir_file(netd_202404, cgroup_202404)
r_dir_file(netd_202404, proc_net_type)
r_dir_file(netd_202404, sysfs_net_202404)
r_dir_file(netd_202404, cgroup_v2_202404)
net_domain(netd_202404)
add_service(netd_202404, netd_service_202404)
add_service(netd_202404, dnsresolver_service_202404)
add_service(netd_202404, mdns_service_202404)
add_service(netd_202404, system_net_netd_service_202404)
type netd_202404, domain, mlstrustedsubject;
