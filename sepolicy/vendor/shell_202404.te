neverallow shell_202404 graphics_device_202404:chr_file { read write };
neverallow shell_202404 hal_keymint_service_202404:service_manager find;
neverallow shell_202404 hal_secureclock_service_202404:service_manager find;
neverallow shell_202404 hal_sharedsecret_service_202404:service_manager find;
neverallow shell_202404 file_type:file link;
neverallow shell_202404 hw_random_device_202404:chr_file { audit_access entrypoint execmod map mounton no_rw_file_perms no_x_file_perms quotaon relabelto };
neverallow shell_202404 port_device_202404:chr_file { audit_access entrypoint execmod map mounton no_rw_file_perms no_x_file_perms quotaon relabelto };
neverallow shell_202404 fuse_device_202404:chr_file { audit_access entrypoint execmod map mounton no_rw_file_perms no_x_file_perms quotaon relabelto };
neverallow shell_202404 dev_type:blk_file { audit_access execmod execute map mounton no_rw_file_perms quotaon relabelto };
neverallow shell_202404 input_device_202404:chr_file no_w_file_perms;
allow shell_202404 logcat_exec_202404:file rx_file_perms;
allow shell_202404 logdr_socket_202404:sock_file write;
allow shell_202404 logd_202404:unix_stream_socket connectto;
allow shell_202404 logd_socket_202404:sock_file write;
allow shell_202404 pstorefs_202404:dir search;
allow shell_202404 pstorefs_202404:file r_file_perms;
allow shell_202404 rootfs_202404:dir r_dir_perms;
allow shell_202404 anr_data_file_202404:dir r_dir_perms;
allow shell_202404 anr_data_file_202404:file r_file_perms;
allow shell_202404 shell_data_file_202404:dir create_dir_perms;
allow shell_202404 shell_data_file_202404:file create_file_perms;
allow shell_202404 shell_data_file_202404:file rx_file_perms;
allow shell_202404 shell_data_file_202404:lnk_file create_file_perms;
allow shell_202404 shell_test_data_file_202404:dir create_dir_perms;
allow shell_202404 shell_test_data_file_202404:file create_file_perms;
allow shell_202404 shell_test_data_file_202404:file rx_file_perms;
allow shell_202404 shell_test_data_file_202404:lnk_file create_file_perms;
allow shell_202404 shell_test_data_file_202404:sock_file create_file_perms;
allow shell_202404 trace_data_file_202404:file { r_file_perms unlink };
allow shell_202404 trace_data_file_202404:dir { r_dir_perms remove_name write };
allow shell_202404 profman_dump_data_file_202404:dir { r_dir_perms remove_name write };
allow shell_202404 profman_dump_data_file_202404:file { r_file_perms unlink };
allow shell_202404 nativetest_data_file_202404:dir r_dir_perms;
allow shell_202404 nativetest_data_file_202404:file rx_file_perms;
allow shell_202404 dumpstate_socket_202404:sock_file write;
allow shell_202404 dumpstate_202404:unix_stream_socket connectto;
allow shell_202404 dumpstate_202404:binder call;
allow shell_202404 devpts_202404:chr_file rw_file_perms;
allow shell_202404 tty_device_202404:chr_file rw_file_perms;
allow shell_202404 console_device_202404:chr_file rw_file_perms;
allow shell_202404 input_device_202404:dir r_dir_perms;
allow shell_202404 input_device_202404:chr_file r_file_perms;
allow shell_202404 system_file_202404:file x_file_perms;
allow shell_202404 toolbox_exec_202404:file rx_file_perms;
allow shell_202404 shell_exec_202404:file rx_file_perms;
allow shell_202404 zygote_exec_202404:file rx_file_perms;
allow shell_202404 boottrace_data_file_202404:dir rw_dir_perms;
allow shell_202404 boottrace_data_file_202404:file create_file_perms;
allow shell_202404 servicemanager_202404:service_manager list;
allow shell_202404 hwservicemanager_202404:binder { call transfer };
allow shell_202404 hwservicemanager_202404:hwservice_manager list;
allow shell_202404 proc_asound_202404:file r_file_perms;
allow shell_202404 proc_filesystems_202404:file r_file_perms;
allow shell_202404 proc_interrupts_202404:file r_file_perms;
allow shell_202404 proc_loadavg_202404:file r_file_perms;
allow shell_202404 proc_meminfo_202404:file r_file_perms;
allow shell_202404 proc_modules_202404:file r_file_perms;
allow shell_202404 proc_pid_max_202404:file r_file_perms;
allow shell_202404 proc_slabinfo_202404:file r_file_perms;
allow shell_202404 proc_stat_202404:file r_file_perms;
allow shell_202404 proc_timer_202404:file r_file_perms;
allow shell_202404 proc_uptime_202404:file r_file_perms;
allow shell_202404 proc_version_202404:file r_file_perms;
allow shell_202404 proc_vmstat_202404:file r_file_perms;
allow shell_202404 proc_zoneinfo_202404:file r_file_perms;
allow shell_202404 sysfs_net_202404:dir r_dir_perms;
allow shell_202404 cgroup_desc_file_202404:file r_file_perms;
allow shell_202404 cgroup_desc_api_file_202404:file r_file_perms;
allow shell_202404 vendor_cgroup_desc_file_202404:file r_file_perms;
allow shell_202404 domain:dir { getattr open read search };
allow shell_202404 domain:file { getattr open read };
allow shell_202404 domain:lnk_file { getattr open read };
allow shell_202404 domain:process getattr;
allow shell_202404 labeledfs_202404:filesystem getattr;
allow shell_202404 proc_202404:filesystem getattr;
allow shell_202404 proc_202404:lnk_file getattr;
allow shell_202404 device_202404:dir getattr;
allow shell_202404 selinuxfs_202404:dir r_dir_perms;
allow shell_202404 selinuxfs_202404:file r_file_perms;
allow shell_202404 bootchart_data_file_202404:dir rw_dir_perms;
allow shell_202404 bootchart_data_file_202404:file create_file_perms;
allow shell_202404 self:process ptrace;
allow shell_202404 sysfs_202404:dir r_dir_perms;
allow shell_202404 sysfs_batteryinfo_202404:dir r_dir_perms;
allow shell_202404 sysfs_batteryinfo_202404:file r_file_perms;
allow shell_202404 ion_device_202404:chr_file rw_file_perms;
allow shell_202404 dev_type:dir r_dir_perms;
allow shell_202404 dev_type:chr_file getattr;
allow shell_202404 dev_type:blk_file getattr;
allow shell_202404 file_contexts_file_202404:file r_file_perms;
allow shell_202404 property_contexts_file_202404:file r_file_perms;
allow shell_202404 seapp_contexts_file_202404:file r_file_perms;
allow shell_202404 service_contexts_file_202404:file r_file_perms;
allow shell_202404 sepolicy_file_202404:file r_file_perms;
allow shell_202404 vendor_shell_exec_202404:file rx_file_perms;
allow shell_202404 vendor_location_exec:file rx_file_perms;
allow shell_202404 vendor_location_lowi_server_exec:file rx_file_perms;
allow shell_202404 vendor_location_xtra_daemon_exec:file rx_file_perms;
allow shell_202404 debugfs_tracing_instances_202404:dir search;
allow shell_202404 vendor_debugfs_kgsl_fence_tracing:file r_file_perms;
allow shell_202404 vendor_debugfs_kgsl_fence_tracing:dir r_dir_perms;
allow shell_202404 vendor_sysfs_kgsl_shell:file rw_file_perms;
allow shell_202404 vendor_location_edgnss_daemon_exec:file rx_file_perms;
allow shell_202404 vendor_location_engine_service_exec:file rx_file_perms;
allow shell_202404 vendor_location_slim_daemon_exec:file rx_file_perms;
allow shell_202404 vendor_location_xtwifi_client_exec:file rx_file_perms;
allow shell_202404 vendor_qsap_location_exec:file rx_file_perms;
allow shell_202404 vendor_location_test_exec:file rx_file_perms;
allow vendor_shell_202404 vendor_shell_exec_202404:file rx_file_perms;
allow vendor_shell_202404 vendor_toolbox_exec_202404:file rx_file_perms;
allow vendor_shell_202404 shell_202404:fd *;
allow vendor_shell_202404 adbd_202404:fd *;
allow vendor_shell_202404 adbd_202404:process sigchld;
allow vendor_shell_202404 adbd_202404:unix_stream_socket { getattr ioctl read write };
allow vendor_shell_202404 devpts_202404:chr_file rw_file_perms;
allow vendor_shell_202404 tty_device_202404:chr_file rw_file_perms;
allow vendor_shell_202404 console_device_202404:chr_file rw_file_perms;
allow vendor_shell_202404 input_device_202404:dir r_dir_perms;
allow vendor_shell_202404 input_device_202404:chr_file rw_file_perms;
allow vendor_shell_202404 property_socket_202404:sock_file write;
allow vendor_shell_202404 init_202404:unix_stream_socket connectto;
allow vendor_shell_202404 persist_vendor_debug_wifi_prop_202404:property_service set;
neverallowxperm shell_202404 domain:ioctl tcp_socket { 0x6900 0x6902 };
neverallowxperm shell_202404 domain:ioctl tcp_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
neverallowxperm shell_202404 domain:ioctl tcp_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
neverallowxperm shell_202404 domain:ioctl udp_socket { 0x6900 0x6902 };
neverallowxperm shell_202404 domain:ioctl udp_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
neverallowxperm shell_202404 domain:ioctl udp_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
neverallowxperm shell_202404 domain:ioctl rawip_socket { 0x6900 0x6902 };
neverallowxperm shell_202404 domain:ioctl rawip_socket { range 0x890b 0x890d 0x8911 0x8914 0x8916 0x8918 0x891a range 0x891c 0x8920 range 0x8922 0x8927 0x8929 range 0x8930 0x8932 range 0x8934 0x8937 0x8939 range 0x8940 0x8941 0x8943 range 0x8946 0x894b range 0x8953 0x8955 range 0x8960 0x8962 range 0x8970 0x8971 range 0x8980 0x8983 range 0x8990 0x8995 range 0x89a0 0x89a3 0x89b0 range 0x89e0 0x89ff };
neverallowxperm shell_202404 domain:ioctl rawip_socket { 0x8b00 0x8b02 0x8b04 0x8b06 0x8b08 0x8b0a 0x8b0c 0x8b0e 0x8b10 range 0x8b14 0x8b1d 0x8b20 0x8b22 0x8b24 0x8b26 0x8b28 range 0x8b2a 0x8b2c range 0x8b30 0x8b36 range 0x8be0 0x8bff };
dontauditx(shell_202404)
domain_auto_trans(shell_202404, vendor_diag_exec, vendor_diag)
domain_auto_trans(shell_202404, vendor_port-bridge_exec, vendor_netmgrd)
domain_auto_trans(shell_202404, vendor_location_garden_app_exec, vendor_location_garden_app)
domain_auto_trans(shell_202404, vendor_netmgrd_exec, vendor_netmgrd)
domain_auto_trans(shell_202404, vendor_diagdciclient_exec, vendor_diag_test)
domain_auto_trans(shell_202404, vendor_location_test_exec, vendor_location_test)
domain_auto_trans(shell_202404, vendor_qmi_ping_exec, vendor_qmi_ping)
domain_auto_trans(shell_202404, vendor_qmi_test_service_exec, vendor_qmi_test_service)
domain_auto_trans(shell_202404, vendor_sensors_test_exec, vendor_sensors_test)
domain_auto_trans(shell_202404, vendor_smd_test_exec, vendor_smd_test)
r_dir_file(shell_202404, system_file_202404)
r_dir_file(shell_202404, proc_net_type)
r_dir_file(shell_202404, cgroup_202404)
r_dir_file(shell_202404, cgroup_v2_202404)
get_prop(shell_202404, logd_prop_202404)
get_prop(vendor_shell_202404, persist_vendor_debug_wifi_prop_202404)
net_domain(shell_202404)
hal_client_domain(shell_202404, vendor_hal_dspmanager)
type shell_202404, domain, mlstrustedsubject;
type vendor_shell_202404, domain;
