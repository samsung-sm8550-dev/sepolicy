neverallow vold fsck_exec:file execute_no_trans;
allow vold update_verifier:binder transfer;
allow vold vdc:binder transfer;
allow vold cache_file:dir r_dir_perms;
allow vold cache_file:file { getattr read };
allow vold cache_file:lnk_file r_file_perms;
allow vold sysfs:file w_file_perms;
allow vold sysfs_devices_block:file w_file_perms;
allow vold sysfs_dm:file w_file_perms;
allow vold sysfs_loop:file w_file_perms;
allow vold sysfs_usb:file w_file_perms;
allow vold sysfs_fs_f2fs:file w_file_perms;
allow vold sysfs_zram_uevent:file w_file_perms;
allow vold rootfs:dir mounton;
allow vold metadata_file:dir search;
allow vold proc:file r_file_perms;
allow vold proc_drop_caches:file r_file_perms;
allow vold proc_drop_caches:file w_file_perms;
allow vold proc_bootconfig:file r_file_perms;
allow vold proc_cmdline:file r_file_perms;
allow vold proc_filesystems:file r_file_perms;
allow vold proc_meminfo:file r_file_perms;
allow vold proc_mounts:file r_file_perms;
allow vold file_contexts_file:file r_file_perms;
allow vold self:process setexec;
allow vold self:process setfscreate;
allow vold self:capability { chown dac_override dac_read_search fowner fsetid mknod net_admin sys_admin };
allow vold self:capability { kill sys_ptrace };
allow vold self:capability sys_nice;
allow vold self:capability sys_chroot;
allow vold self:cap_userns { chown dac_override dac_read_search fowner fsetid mknod net_admin sys_admin };
allow vold self:cap_userns { kill sys_ptrace };
allow vold self:cap_userns sys_nice;
allow vold self:cap_userns sys_chroot;
allow vold self:netlink_kobject_uevent_socket create_socket_perms_no_ioctl;
allow vold self:capability2 block_suspend;
allow vold self:cap2_userns block_suspend;
allow vold e2fs_exec:file rx_file_perms;
allow vold system_file:file x_file_perms;
allow vold block_device:dir create_dir_perms;
allow vold device:dir write;
allow vold devpts:chr_file rw_file_perms;
allow vold sdcard_type:dir mounton;
allow vold sdcard_type:dir create_dir_perms;
allow vold sdcard_type:filesystem { mount remount unmount };
allow vold sdcard_type:file create_file_perms;
allow vold fuse:dir mounton;
allow vold fuse:dir create_dir_perms;
allow vold fuse:filesystem { mount remount unmount };
allow vold fuse:filesystem relabelfrom;
allow vold fuse:file create_file_perms;
allow vold mnt_media_rw_file:dir create_dir_perms;
allow vold mnt_media_rw_file:file create_file_perms;
allow vold storage_file:dir create_dir_perms;
allow vold storage_file:dir mounton;
allow vold storage_file:file create_file_perms;
allow vold media_rw_data_file:dir create_dir_perms;
allow vold media_rw_data_file:dir mounton;
allow vold media_rw_data_file:file create_file_perms;
allow vold mnt_media_rw_stub_file:dir { create getattr mounton rmdir setattr };
allow vold storage_stub_file:dir { create getattr mounton rmdir setattr };
allow vold mnt_user_file:dir { create_dir_perms mounton };
allow vold mnt_user_file:lnk_file create_file_perms;
allow vold mnt_user_file:file create_file_perms;
allow vold mnt_pass_through_file:dir { create_dir_perms mounton };
allow vold mnt_pass_through_file:lnk_file create_file_perms;
allow vold mnt_expand_file:dir { create_dir_perms mounton };
allow vold apk_data_file:dir { create getattr setattr };
allow vold apk_data_file:dir { mounton rw_dir_perms };
allow vold apk_data_file:file { rw_file_perms unlink };
allow vold shell_data_file:dir { create getattr setattr };
allow vold system_userdir_file:dir { create getattr setattr };
allow vold media_userdir_file:dir { create getattr ioctl open read setattr };
allow vold apk_tmp_file:dir { mounton r_dir_perms };
allow vold incremental_control_file:file { r_file_perms relabelto };
allow vold tmpfs:filesystem { mount unmount };
allow vold tmpfs:dir create_dir_perms;
allow vold tmpfs:dir mounton;
allow vold loop_control_device:chr_file rw_file_perms;
allow vold loop_device:blk_file { create rw_file_perms setattr unlink };
allow vold vold_device:blk_file { create rw_file_perms setattr unlink };
allow vold dm_device:chr_file rw_file_perms;
allow vold dm_device:blk_file rw_file_perms;
allow vold domain:process { sigkill signal };
allow vold kmsg_device:chr_file rw_file_perms;
allow vold fsck_exec:file { execute r_file_perms };
allow vold fscklogs:dir rw_dir_perms;
allow vold fscklogs:file create_file_perms;
allow vold labeledfs:filesystem { mount remount unmount };
allow vold system_data_root_file:dir { create_dir_perms mounton };
allow vold system_data_file:dir { create_dir_perms mounton };
allow vold system_data_file:lnk_file getattr;
allow vold system_data_file:file read;
allow vold vendor_data_file:dir create_dir_perms;
allow vold kernel:process setsched;
allow vold asec_image_file:file create_file_perms;
allow vold asec_image_file:dir rw_dir_perms;
allow vold asec_apk_file:dir { create_dir_perms mounton relabelfrom relabelto };
allow vold asec_apk_file:file { r_file_perms relabelfrom relabelto setattr };
allow vold asec_public_file:dir { relabelto setattr };
allow vold asec_public_file:file { relabelto setattr };
allow vold unlabeled:dir { r_dir_perms relabelfrom setattr };
allow vold unlabeled:file { r_file_perms relabelfrom setattr };
allow vold fusectlfs:file rw_file_perms;
allow vold fusectlfs:dir rw_dir_perms;
allow vold sysfs_wake_lock:file rw_file_perms;
allow vold system_suspend_server:binder { call transfer };
allow vold system_suspend_server:fd *;
allow vold system_suspend_hwservice:hwservice_manager find;
allow vold hwservicemanager:binder { call transfer };
allow vold hidl_manager_hwservice:hwservice_manager find;
allow vold hal_system_suspend_service:service_manager find;
allow vold servicemanager:binder { call transfer };
allow vold su:tcp_socket { accept getopt read write };
allow vold system_server:binder { call transfer };
allow vold system_server:fd *;
allow vold permission_service:service_manager find;
allow vold userdata_block_device:blk_file rw_file_perms;
allow vold zoned_block_device:blk_file rw_file_perms;
allow vold metadata_block_device:blk_file rw_file_perms;
allow vold unencrypted_data_file:file create_file_perms;
allow vold unencrypted_data_file:dir create_dir_perms;
allow vold vold_data_file:dir create_dir_perms;
allow vold vold_data_file:file create_file_perms;
allow vold vold_metadata_file:dir create_dir_perms;
allow vold vold_metadata_file:file create_file_perms;
allow vold init:key { search setattr write };
allow vold vold:key { search setattr write };
allow vold fuse_device:chr_file rw_file_perms;
allow vold app_fusefs:filesystem { relabelfrom relabelto };
allow vold app_fusefs:filesystem { mount unmount };
allow vold app_fuse_file:dir rw_dir_perms;
allow vold app_fuse_file:file { append getattr open read write };
allow vold toolbox_exec:file rx_file_perms;
allow vold user_profile_root_file:dir create_dir_perms;
allow vold user_profile_data_file:dir create_dir_perms;
allow vold misc_block_device:blk_file w_file_perms;
allow vold mnt_vendor_file:dir search;
allow vold mnt_vendor_file:dir { ioctl open read };
allow vold gsi_metadata_file_type:dir search;
allow vold gsi_public_metadata_file:file r_file_perms;
allow vold vendor_apex_file:file r_file_perms;
allow vold vendor_sysfs_mmc_host:file w_file_perms;
dontaudit vold self:capability sys_resource;
dontaudit vold self:cap_userns sys_resource;
allowxperm vold fs_type:ioctl dir 0x5879;
allowxperm vold file_type:ioctl dir 0x5879;
allowxperm vold data_file_type:ioctl dir { 0x6613 0x6615 range 0x6617 0x6618 0x661a };
allowxperm vold vold_metadata_file:ioctl file 0x660b;
allowxperm vold vold_metadata_file:ioctl file 0xf514;
allowxperm vold vold_data_file:ioctl file 0x660b;
allowxperm vold vold_data_file:ioctl file 0xf514;
allowxperm vold media_rw_data_file:ioctl file { range 0x581f 0x5820 };
allowxperm vold media_rw_data_file:ioctl file { range 0x6601 0x6602 };
allowxperm vold media_rw_data_file:ioctl dir { range 0x581f 0x5820 };
allowxperm vold media_rw_data_file:ioctl dir { range 0x6601 0x6602 };
allowxperm vold media_userdir_file:ioctl dir { range 0x6601 0x6602 };
allowxperm vold loop_device:ioctl blk_file { range 0x4c00 0x4c01 range 0x4c04 0x4c05 0x4c82 };
allowxperm vold vold_device:ioctl blk_file { 0x1260 0x1277 };
allowxperm vold dm_device:ioctl blk_file { 0x1277 0x127d range 0x1282 0x1283 };
allowxperm vold userdata_block_device:ioctl blk_file 0x127d;
allowxperm vold metadata_block_device:ioctl blk_file 0x127d;
r_dir_file(vold, rootfs)
r_dir_file(vold, metadata_file)
r_dir_file(vold, domain)
get_prop(vold, hwservicemanager_prop)
get_prop(vold, vendor_tee_listener_prop)
hal_client_domain(vold, hal_bootctl)
hal_client_domain(vold, hal_health_storage)
add_service(vold, vold_service)
type vold, domain, mlstrustedsubject;
