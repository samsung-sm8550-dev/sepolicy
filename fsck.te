neverallow fsck vold_device:blk_file no_rw_file_perms;
neverallow fsck root_block_device:blk_file no_rw_file_perms;
neverallow fsck frp_block_device:blk_file no_rw_file_perms;
neverallow fsck system_block_device:blk_file no_rw_file_perms;
neverallow fsck recovery_block_device:blk_file no_rw_file_perms;
neverallow fsck boot_block_device:blk_file no_rw_file_perms;
neverallow fsck swap_block_device:blk_file no_rw_file_perms;
allow fsck tmpfs:chr_file { ioctl read write };
allow fsck devpts:chr_file { getattr ioctl read write };
allow fsck vold:fd *;
allow fsck vold:fifo_file { getattr read write };
allow fsck vold:netlink_socket { read write };
allow fsck userdata_block_device:blk_file rw_file_perms;
allow fsck cache_block_device:blk_file rw_file_perms;
allow fsck dm_device:blk_file rw_file_perms;
allow fsck metadata_file:dir getattr;
allow fsck block_device:dir search;
allow fsck mirror_data_file:dir search;
allow fsck dev_type:blk_file getattr;
allow fsck proc_mounts:file r_file_perms;
allow fsck proc_swaps:file r_file_perms;
allow fsck rootfs:dir r_dir_perms;
allow fsck efsblk_device:blk_file rw_file_perms;
allow fsck persdatablk_device:blk_file rw_file_perms;
allow fsck persist_block_device:blk_file rw_file_perms;
allow fsck sbfs_block_device:blk_file rw_file_perms;
allow fsck cpefs_block_device:blk_file rw_file_perms;
allow fsck omr_block_device:blk_file rw_file_perms;
allow fsck keyrefuge_block_device:blk_file rw_file_perms;
allow fsck dqmdbgblk_device:blk_file rw_file_perms;
allow fsck emmcblk_device:blk_file rw_file_perms;
allow fsck sec_efsblk_device:blk_file rw_file_perms;
allow fsck keydata_block_device:blk_file rw_file_perms;
allow fsck proc_fslog:dir r_dir_perms;
allow fsck proc_fslog:file rw_file_perms;
allow fsck knox_dar_device:chr_file r_file_perms;
allow fsck carrier_block_device:blk_file rw_file_perms;
allow fsck self:capability sys_admin;
allow fsck vendor_sysfs_scsi_host:file r_file_perms;
allow fsck vendor_persist_block_device:blk_file rw_file_perms;
allow fsck vendor_qmcs_block_device:blk_file rw_file_perms;
allowxperm fsck dev_type:ioctl blk_file { 0x125e 0x127c };
allowxperm fsck dm_device:ioctl blk_file { 0x1260 0x1271 };
allowxperm fsck vendor_qmcs_block_device:ioctl blk_file 0x1260;
r_dir_file(fsck, omr_file)
type fsck, domain;
type fsck_exec, exec_type, file_type, system_file_type;
